{% extends "admin/base.html" %}

{% block title %}Edit Vehicle - Admin{% endblock %}
{% block page_title %}Edit Vehicle{% endblock %}

{% block content %}
<div class="form-container">
    <div class="form-card">
        <form method="POST" enctype="multipart/form-data">
            <div class="form-section">
                <h3>Basic Information</h3>
                
                <div class="form-row">
                    <div class="form-group col-md-4">
                        <label>Make *</label>
                        <input type="text" name="make" class="form-control" value="{{ car.make }}" required>
                    </div>
                    
                    <div class="form-group col-md-4">
                        <label>Model *</label>
                        <input type="text" name="model" class="form-control" value="{{ car.model }}" required>
                    </div>
                    
                    <div class="form-group col-md-4">
                        <label>Year *</label>
                        <input type="number" name="year" class="form-control" value="{{ car.year }}" min="1900" max="2030" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group col-md-4">
                        <label>License Plate *</label>
                        <input type="text" name="license_plate" class="form-control" value="{{ car.license_plate }}" required>
                    </div>
                    
                    <div class="form-group col-md-4">
                        <label>VIN *</label>
                        <input type="text" name="vin" class="form-control" value="{{ car.vin }}" required>
                    </div>
                    
                    <div class="form-group col-md-4">
                        <label>Agency/Branch</label>
                        <input type="text" name="agency" class="form-control" value="{{ car.agency or '' }}" placeholder="e.g., Melbourne CBD">
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h3>Vehicle Details</h3>
                
                <div class="form-row">
                    <div class="form-group col-md-3">
                        <label>Category *</label>
                        <select name="category" class="form-control" required>
                            <option value="">Select Category</option>
                            <option value="economy" {% if car.category and car.category.value == 'economy' %}selected{% endif %}>Economy</option>
                            <option value="compact" {% if car.category and car.category.value == 'compact' %}selected{% endif %}>Compact</option>
                            <option value="midsize" {% if car.category and car.category.value == 'midsize' %}selected{% endif %}>Midsize</option>
                            <option value="fullsize" {% if car.category and car.category.value == 'fullsize' %}selected{% endif %}>Full Size</option>
                            <option value="luxury" {% if car.category and car.category.value == 'luxury' %}selected{% endif %}>Luxury</option>
                            <option value="suv" {% if car.category and car.category.value == 'suv' %}selected{% endif %}>SUV</option>
                            <option value="minivan" {% if car.category and car.category.value == 'minivan' %}selected{% endif %}>Minivan</option>
                            <option value="convertible" {% if car.category and car.category.value == 'convertible' %}selected{% endif %}>Convertible</option>
                            <option value="sports" {% if car.category and car.category.value == 'sports' %}selected{% endif %}>Sports</option>
                            <option value="electric" {% if car.category and car.category.value == 'electric' %}selected{% endif %}>Electric</option>
                        </select>
                    </div>
                    
                    <div class="form-group col-md-3">
                        <label>Seats *</label>
                        <input type="number" name="seats" class="form-control" value="{{ car.seats }}" min="2" max="12" required>
                    </div>
                    
                    <div class="form-group col-md-3">
                        <label>Transmission *</label>
                        <select name="transmission" class="form-control" required>
                            <option value="Automatic" {% if car.transmission == 'Automatic' %}selected{% endif %}>Automatic</option>
                            <option value="Manual" {% if car.transmission == 'Manual' %}selected{% endif %}>Manual</option>
                        </select>
                    </div>
                    
                    <div class="form-group col-md-3">
                        <label>Fuel Type *</label>
                        <select name="fuel_type" class="form-control" required>
                            <option value="Gasoline" {% if car.fuel_type == 'Gasoline' %}selected{% endif %}>Gasoline</option>
                            <option value="Diesel" {% if car.fuel_type == 'Diesel' %}selected{% endif %}>Diesel</option>
                            <option value="Electric" {% if car.fuel_type == 'Electric' %}selected{% endif %}>Electric</option>
                            <option value="Hybrid" {% if car.fuel_type == 'Hybrid' %}selected{% endif %}>Hybrid</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group col-md-4">
                        <label>Color</label>
                        <input type="text" name="color" class="form-control" value="{{ car.color or '' }}">
                    </div>
                    
                    <div class="form-group col-md-4">
                        <label>Current Location</label>
                        <input type="text" name="current_location" class="form-control" value="{{ car.current_location or '' }}" placeholder="e.g., 123 Collins St, Melbourne">
                    </div>
                    
                    <div class="form-group col-md-4">
                        <label>Status *</label>
                        <select name="status" class="form-control" required>
                            {% for status in CarStatus %}
                            <option value="{{ status.value }}" {% if car.status == status %}selected{% endif %}>
                                {{ status.value.replace('_', ' ').title() }}
                            </option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h3>Pricing</h3>
                
                <div class="form-row">
                    <div class="form-group col-md-4">
                        <label>Daily Rate ($) *</label>
                        <input type="number" name="daily_rate" class="form-control" value="{{ car.daily_rate }}" step="0.01" min="0" required>
                    </div>
                    
                    <div class="form-group col-md-4">
                        <label>Weekly Rate ($)</label>
                        <input type="number" name="weekly_rate" class="form-control" value="{{ car.weekly_rate or '' }}" step="0.01" min="0">
                    </div>
                    
                    <div class="form-group col-md-4">
                        <label>Monthly Rate ($)</label>
                        <input type="number" name="monthly_rate" class="form-control" value="{{ car.monthly_rate or '' }}" step="0.01" min="0">
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h3>Maintenance Information</h3>
                
                <div class="form-row">
                    <div class="form-group col-md-4">
                        <label>Current Odometer (km) *</label>
                        <input type="number" name="current_odometer" class="form-control" value="{{ car.current_odometer }}" min="0" required>
                    </div>
                    
                    <div class="form-group col-md-4">
                        <label>Last Service Odometer (km)</label>
                        <input type="number" name="last_service_odometer" class="form-control" value="{{ car.last_service_odometer }}" min="0">
                    </div>
                    
                    <div class="form-group col-md-4">
                        <label>Service Threshold (km)</label>
                        <input type="number" name="service_threshold" class="form-control" value="{{ car.service_threshold }}" min="1000">
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h3>Features</h3>
                
                <div class="features-grid">
                    {% set available_features = ['GPS', 'Bluetooth', 'Backup Camera', 'Cruise Control', 'Air Conditioning', 'Heated Seats', 'Sunroof', 'USB Charging'] %}
                    {% for feature in available_features %}
                    <div class="form-check">
                        <input type="checkbox" name="features" value="{{ feature }}" class="form-check-input" 
                               id="feature-{{ loop.index }}"
                               {% if car.features and feature in car.features %}checked{% endif %}>
                        <label class="form-check-label" for="feature-{{ loop.index }}">{{ feature }}</label>
                    </div>
                    {% endfor %}
                </div>
            </div>
            
            <div class="form-actions">
                <a href="{{ url_for('admin.fleet') }}" class="btn btn-secondary">Cancel</a>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save"></i> Update Vehicle
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}